# Correctness tests: verify output uses valid Speakeasy syntax

tests:
  - skill: configure-speakeasy-extensions
    prompt: "Add retry configuration to GET /users endpoint with exponential backoff"
    assertions:
      - type: contains
        value: "x-speakeasy-retries"
      - type: contains
        value: "strategy"
      - type: contains
        value: "backoff"
      - type: valid_yaml

  - skill: configure-speakeasy-extensions
    prompt: "Make all enums in my OpenAPI spec open to handle unknown values"
    assertions:
      - type: contains
        value: "x-speakeasy-unknown-values"
      - type: contains
        value: "allow"
      - type: valid_yaml

  - skill: configure-speakeasy-extensions
    prompt: "Add cursor pagination to my /events endpoint"
    assertions:
      - type: contains
        value: "x-speakeasy-pagination"
      - type: contains
        value: "cursor"
      - type: valid_yaml

  - skill: generate-terraform-provider
    prompt: "Annotate a Pet schema and its CRUD operations for Terraform provider generation"
    assertions:
      - type: contains
        value: "x-speakeasy-entity"
      - type: contains
        value: "x-speakeasy-entity-operation"
      - type: contains
        value: "#create"
      - type: contains
        value: "#read"
      - type: not_contains
        value: "#list"

  - skill: manage-openapi-overlays
    prompt: "Create an overlay to rename the /users GET operation to listUsers"
    assertions:
      - type: contains
        value: "overlay: 1.0.0"
      - type: contains
        value: "actions"
      - type: contains
        value: "target"
      - type: contains
        value: "$.paths"
      - type: valid_yaml

  - skill: extract-openapi-fastapi
    prompt: "How do I extract the OpenAPI spec from my FastAPI app without running the server?"
    assertions:
      - type: contains
        value: "app.openapi()"
      - type: contains
        value: "json.dump"

  - skill: generate-sdk-for-python
    prompt: "What's the gen.yaml configuration for async Python SDK with Pydantic models?"
    assertions:
      - type: contains
        value: "gen.yaml"
      - type: contains
        value: "python"
      - type: valid_yaml
