# End-to-End Workflow Tests
# These tests verify complete SDK generation workflows

tests:
  - name: full-typescript-workflow
    skill: start-new-sdk-project
    type: workflow
    target: typescript
    spec_file: fixtures/petstore-minimal.yaml
    task: |
      Complete the full SDK generation workflow:
      1. Lint the OpenAPI spec at openapi.yaml to check for issues using `speakeasy lint openapi -s openapi.yaml`
      2. Generate a TypeScript SDK using `speakeasy quickstart` (NOT `speakeasy generate sdk`).
         IMPORTANT: You MUST use `speakeasy quickstart --skip-interactive --output console -s openapi.yaml -t typescript -n PetstoreSDK -p petstore-sdk`
         The quickstart command creates .speakeasy/workflow.yaml which is required.
      3. Verify that .speakeasy/workflow.yaml was created (this file is only created by quickstart, not generate)
    steps:
      - name: lint-spec
        command: speakeasy lint
      - name: generate-sdk
        command: speakeasy quickstart
      - name: verify-workflow
        creates_file: .speakeasy/workflow.yaml

  - name: overlay-then-generate
    skill: configure-speakeasy-extensions
    type: workflow
    spec_file: fixtures/petstore-poor-naming.yaml
    task: |
      Improve SDK quality through overlays then generate:
      1. Analyze the spec with speakeasy lint
      2. Use speakeasy suggest to generate naming improvements
      3. Create the SDK with the improved naming
    steps:
      - name: lint-spec
        command: speakeasy lint
      - name: suggest-names
        command: speakeasy suggest
