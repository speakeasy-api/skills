# SDK Generation Tests
# These tests verify that skills guide successful SDK generation
#
# Compilation modes:
#   - quick: Fast type/syntax checks only (2-15s per target)
#   - full: Complete build with dependencies (30-120s per target)

tests:
  - name: typescript-sdk-from-clean-spec
    skill: start-new-sdk-project
    type: generation
    target: typescript
    spec_file: fixtures/petstore-minimal.yaml
    verify_compilation: true
    compile_mode: quick  # Uses tsc --noEmit instead of npm run build
    verify_workflow: true
    verify_gen_yaml: true
    task: |
      Generate a TypeScript SDK from the OpenAPI spec.
      Use speakeasy quickstart with appropriate naming.

  - name: python-sdk-from-clean-spec
    skill: start-new-sdk-project
    type: generation
    target: python
    spec_file: fixtures/petstore-minimal.yaml
    verify_compilation: true
    compile_mode: quick  # Uses python -m compileall
    verify_workflow: true
    verify_gen_yaml: true
    task: |
      Generate a Python SDK from the OpenAPI spec.
      Use speakeasy quickstart with appropriate naming.

  - name: go-sdk-from-clean-spec
    skill: start-new-sdk-project
    type: generation
    target: go
    spec_file: fixtures/petstore-minimal.yaml
    verify_compilation: true
    compile_mode: quick  # Uses go vet instead of go build
    verify_workflow: true
    verify_gen_yaml: true
    task: |
      Generate a Go SDK from the OpenAPI spec.
      Use speakeasy quickstart with appropriate naming.

  - name: typescript-sdk-with-pagination
    skill: configure-speakeasy-extensions
    type: generation
    target: typescript
    spec_file: fixtures/paginated-api.yaml
    verify_compilation: true
    compile_mode: quick
    verify_workflow: true
    verify_gen_yaml: true
    task: |
      Generate a TypeScript SDK from this paginated API spec.
      First add x-speakeasy-pagination extensions for the list endpoints,
      then generate the SDK. The SDK should have pagination support built-in.

  - name: typescript-sdk-with-hooks
    skill: customize-sdk-hooks
    type: generation
    target: typescript
    spec_file: fixtures/petstore-minimal.yaml
    verify_compilation: true
    compile_mode: quick
    verify_workflow: true
    verify_gen_yaml: true
    verify_hooks: true
    task: |
      Generate a TypeScript SDK and set up custom hooks.
      Create a beforeRequest hook that adds a custom header.

  - name: typescript-sdk-with-mcp
    skill: generate-mcp-server
    type: generation
    target: typescript
    spec_file: fixtures/petstore-minimal.yaml
    verify_compilation: true
    compile_mode: quick
    verify_workflow: true
    verify_gen_yaml: true
    verify_mcp: true
    task: |
      Generate a TypeScript SDK with MCP server support.
      Enable MCP server generation in the configuration.

  - name: multi-target-sdk-generation
    skill: generate-multi-target-sdk
    type: generation
    target: typescript
    spec_file: fixtures/petstore-minimal.yaml
    verify_compilation: true
    compile_mode: quick
    verify_workflow: true
    verify_multi_target: true
    task: |
      Generate SDKs for multiple targets (TypeScript and Python).
      Configure the workflow.yaml for multi-target generation.
